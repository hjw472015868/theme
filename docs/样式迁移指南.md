# æ ·å¼è¿ç§»æŒ‡å—

> æŒ‡å¯¼å°† **ç°æœ‰é¡¹ç›®ï¼ˆå°¤å…¶æ˜¯ Next.jsï¼‰** çš„æ ·å¼ä½“ç³»è¿ç§»åˆ° `@km-design/theme-system`ï¼Œå®ç°ä¸»é¢˜é…ç½®ä¸­å¿ƒçš„è”åŠ¨ã€‚

---

## ğŸ“Œ è¿ç§»ç›®æ ‡

1. **ä¸»é¢˜ç»Ÿä¸€**ï¼šæ‰€æœ‰é¢œè‰²ã€é—´è·ã€åœ†è§’ç­‰è§†è§‰å˜é‡ç»Ÿä¸€ä»ä¸»é¢˜åŒ…è¯»å–ã€‚
2. **å¯é…ç½®**ï¼šåœ¨ä¸»é¢˜é…ç½®ä¸­å¿ƒè°ƒæ•´é…ç½®åï¼Œé¡µé¢å¯ä»¥å®æ—¶è”åŠ¨å˜åŒ–ã€‚
3. **å¯ç»´æŠ¤**ï¼šæ–°è€ç»„ä»¶éƒ½èƒ½éµå¾ªä¸€è‡´çš„å˜é‡è§„èŒƒï¼Œåç»­æ–°å¢ç»„ä»¶æ— éœ€é‡æ–°é€‚é…ã€‚

---

## ğŸ§  æ ¸å¿ƒæ¦‚å¿µå›é¡¾

- **ä¸»é¢˜é¢„è®¾ï¼ˆPresetï¼‰**ï¼š`presets/*.json` ä¸­çš„ä¸»é¢˜é…ç½®ï¼ŒåŒ…å«é¢œè‰²ã€æ’ç‰ˆã€é—´è·ç­‰ä¿¡æ¯ã€‚
- **CSS Variables**ï¼šä¸»é¢˜è¿è¡Œæ—¶ä¼šä¸ºæ¯ä¸ªä»¤ç‰Œç”Ÿæˆå½¢å¦‚ `--primary`ã€`--spacing-md` çš„å˜é‡ã€‚
- **ThemeProvider**ï¼šè´Ÿè´£æ³¨å†Œä¸»é¢˜ã€åŒæ­¥ CSS å˜é‡ã€æä¾› React Hooksã€‚
- **ThemeEditor**ï¼šå¯è§†åŒ–é…ç½®ä¸­å¿ƒï¼Œè°ƒæ•´å˜é‡ â†’ è‡ªåŠ¨å†™å…¥ CSS Variablesã€‚

âš ï¸ å¦‚æœé¡¹ç›®ä»åœ¨ä½¿ç”¨ç¡¬ç¼–ç é¢œè‰²ï¼ˆå¦‚ `#1890ff`ï¼‰æˆ–å›ºå®šçš„ `padding: 12px`ï¼Œåˆ™æ— æ³•äº«å—ä¸»é¢˜åˆ‡æ¢å¸¦æ¥çš„èƒ½åŠ›ï¼Œå¿…é¡»æ”¹ç”¨ä¸»é¢˜å˜é‡ã€‚

---

## ğŸ› ï¸ è¿ç§»æµç¨‹æ€»è§ˆ

| æ­¥éª¤ | è¯´æ˜                    | å…³æ³¨ç‚¹                                               |
| ---- | ----------------------- | ---------------------------------------------------- |
| 1    | å®‰è£…å¹¶æ³¨å†Œä¸»é¢˜åŒ…        | `ThemeProvider` åŒ…è£¹åº”ç”¨                             |
| 2    | åŒæ­¥ Tailwindã€å…¨å±€æ ·å¼ | ç»Ÿä¸€æŠŠé¢œè‰²/é—´è·æ”¹ä¸º `var(--token)`                   |
| 3    | ç»„ä»¶æ ·å¼è¿ç§»            | å°† CSSã€SCSSã€styled-componentsã€Tailwind ç­‰æ”¹ç”¨å˜é‡ |
| 4    | éªŒè¯ä¸»é¢˜åˆ‡æ¢            | é€šè¿‡ ThemeEditor æ£€æŸ¥æ˜¯å¦è”åŠ¨                        |

---

## ç¬¬ 1 æ­¥ï¼šåœ¨ Next.js é¡¹ç›®ä¸­æ³¨å†Œä¸»é¢˜

1. å®‰è£…ä¾èµ–ï¼ˆå»ºè®®ä½¿ç”¨ `latest` æ ‡ç­¾ï¼Œè¯¦è§ã€Šä½¿ç”¨æŒ‡å—ã€‹ï¼‰ï¼š

   ```bash
   pnpm add git+https://github.com/hjw472015868/theme.git#latest
   ```

2. åœ¨ `app/layout.tsx` ä¸­åŒ…è£¹åº”ç”¨ï¼š

   ```tsx
   import { ThemeWrapper } from '@/theme'; // å…¼å®¹å±‚ï¼Œå†…éƒ¨ä½¿ç”¨ NextThemeProvider

   export default function RootLayout({ children }: { children: React.ReactNode }) {
     return (
       <html lang="zh-CN">
         <body>
           <ThemeWrapper>{children}</ThemeWrapper>
         </body>
       </html>
     );
   }
   ```

3. åœ¨é¡¶æ æˆ–ä»»æ„ä½ç½®å¼•å…¥ä¸»é¢˜åˆ‡æ¢å™¨ / ç¼–è¾‘å™¨ï¼š
   ```tsx
   import { ThemeSwitcher, ThemeEditor } from '@km-design/theme-system';
   ```

---

## ç¬¬ 2 æ­¥ï¼šç»Ÿä¸€ Tailwind & å…¨å±€æ ·å¼

### 2.1 Tailwind é…ç½®

å°† `tailwind.config.js` çš„é¢œè‰²ã€é—´è·ã€åœ†è§’ç­‰æ˜ å°„åˆ°ä¸»é¢˜å˜é‡ï¼š

```js
const sharedColors = {
  background: 'var(--background)',
  foreground: 'var(--foreground)',
  card: {
    DEFAULT: 'var(--card)',
    foreground: 'var(--card-foreground)',
  },
  primary: {
    DEFAULT: 'var(--primary)',
    foreground: 'var(--primary-foreground)',
    50: 'var(--color-primary-50)',
    100: 'var(--color-primary-100)',
    500: 'var(--color-primary-500)',
    900: 'var(--color-primary-900)',
  },
  accent: {
    DEFAULT: 'var(--accent)',
    foreground: 'var(--accent-foreground)',
  },
};

module.exports = {
  content: ['./app/**/*.{ts,tsx}', './components/**/*.{ts,tsx}'],
  darkMode: 'class',
  theme: {
    extend: {
      colors: sharedColors,
      spacing: {
        xs: 'var(--spacing-xs)',
        sm: 'var(--spacing-sm)',
        md: 'var(--spacing-md)',
        lg: 'var(--spacing-lg)',
      },
      borderRadius: {
        sm: 'var(--radius-sm)',
        md: 'var(--radius-md)',
        lg: 'var(--radius-lg)',
      },
      boxShadow: {
        sm: 'var(--shadow-sm)',
        md: 'var(--shadow-md)',
        lg: 'var(--shadow-lg)',
      },
    },
  },
};
```

âœ… å¥½å¤„ï¼šTailwind ç±»åæ— éœ€æ”¹åŠ¨ï¼Œé…ç½®å³å¯é€‚é…ä¸»é¢˜ã€‚

### 2.2 å…¨å±€ CSS

åœ¨ `app/styles/globals.css` / `styles/globals.scss` ä¸­ï¼ŒæŠŠç¡¬ç¼–ç é¢œè‰²æ›¿æ¢ä¸ºå˜é‡ï¼š

```css
body {
  color: var(--foreground);
  background: var(--background);
}

.app-card {
  color: var(--card-foreground);
  background: var(--card);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-md);
}
```

> ğŸ’¡ **å‘½åè§„èŒƒ**ï¼šä¼˜å…ˆä½¿ç”¨è¯­ä¹‰å˜é‡ï¼ˆ`--card`ã€`--muted-foreground`ï¼‰ï¼Œå…¶æ¬¡ä½¿ç”¨è‰²æ¿ï¼ˆ`--color-primary-500`ï¼‰ã€‚

---

## ç¬¬ 3 æ­¥ï¼šè¿ç§»ç»„ä»¶æ ·å¼

æ ¹æ®ç»„ä»¶ä½¿ç”¨çš„æŠ€æœ¯æ ˆï¼Œéµå¾ªä»¥ä¸‹æ¨¡æ¿ï¼š

### 3.1 CSS / SCSS æ¨¡å—

```scss
.button {
  padding: var(--spacing-sm) var(--spacing-md);
  color: var(--primary-foreground);
  background-color: var(--primary);
  border-radius: var(--radius-md);
}
```

### 3.2 styled-components / emotion

```tsx
const Button = styled.button`
  background: var(--primary);
  color: var(--primary-foreground);
  padding: var(--spacing-sm) var(--spacing-md);
  border-radius: var(--radius-md);
`;
```

### 3.3 inline style / className

```tsx
<div
  style={{
    background: 'var(--card)',
    color: 'var(--card-foreground)',
    padding: 'var(--spacing-md)',
  }}
/>
```

### 3.4 JS é€»è¾‘ä¸­ä½¿ç”¨å˜é‡

```tsx
const getPrimaryColor = () =>
  getComputedStyle(document.documentElement).getPropertyValue('--primary');
```

---

## ç¬¬ 4 æ­¥ï¼šè”åŠ¨éªŒè¯

1. å¯åŠ¨é¡¹ç›®ï¼š`pnpm dev`
2. åœ¨é¡µé¢å³ä¸Šè§’æ‰“å¼€ **ä¸»é¢˜é…ç½®ä¸­å¿ƒ**
3. åˆ‡æ¢ä¸»é¢˜ã€è°ƒæ•´é¢œè‰²/é—´è·
4. æ£€æŸ¥é¡µé¢æ˜¯å¦å³æ—¶å˜åŒ–ï¼š
   - å¡ç‰‡èƒŒæ™¯ã€æŒ‰é’®é¢œè‰²ç­‰æ˜¯å¦è”åŠ¨ï¼Ÿ
   - Tailwind ç±»åç”Ÿæˆçš„æ ·å¼æ˜¯å¦å®æ—¶æ›´æ–°ï¼Ÿ
   - è‡ªå®šä¹‰ç»„ä»¶æ˜¯å¦éµå¾ªå˜é‡ï¼Ÿ

âœ… å¦‚æœè”åŠ¨æ­£å¸¸ï¼Œè¯´æ˜è¿ç§»å®Œæˆã€‚

---

## ğŸ”„ å¸¸è§è¿ç§»åœºæ™¯

| åœºæ™¯ | åŸå†™æ³• | è¿ç§»å†™æ³• |
| --- | --- | --- |
| æŒ‰é’®èƒŒæ™¯ | `background: #ff4d4f` | `background: var(--primary)` |
| è¾¹æ¡† | `border: 1px solid #f0f0f0` | `border: 1px solid var(--border)` |
| é˜´å½± | `box-shadow: 0 2px 8px rgba(0,0,0,0.12)` | `box-shadow: var(--shadow-md)` |
| å­—ä½“ | `font-family: "PingFang SC"` | `font-family: var(--font-sans)`ï¼ˆä½¿ç”¨ typography é…ç½®ï¼‰ |
| é—´è· | `margin: 16px` | `margin: var(--spacing-lg)` |

---

## âœ… æœ€ç»ˆæ£€æŸ¥æ¸…å•

- [ ] `ThemeProvider` å·²åŒ…è£¹åº”ç”¨ï¼ŒThemeEditor å¯æ‰“å¼€
- [ ] Tailwind é…ç½®ä¸­çš„é¢œè‰²/é—´è·/åœ†è§’å…¨éƒ¨å¼•ç”¨ `var(--token)`
- [ ] å…¨å±€ CSS æ— ç¡¬ç¼–ç é¢œè‰²ï¼Œå…¨éƒ¨æ”¹ä¸ºè¯­ä¹‰å˜é‡
- [ ] ç»„ä»¶æ ·å¼ã€styled-componentsã€inline style å‡ä½¿ç”¨ `var(--token)`
- [ ] ThemeEditor ä¸­ä¿®æ”¹ä»»æ„å˜é‡ï¼Œé¡µé¢å®æ—¶è”åŠ¨
- [ ] æ–°å»ºç»„ä»¶æ—¶çº¦å®šï¼š**ç¦ç”¨ç¡¬ç¼–ç é¢œè‰²**ï¼Œç»Ÿä¸€ä»ä¸»é¢˜å˜é‡è¯»å–

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- ã€Š[ä½¿ç”¨æŒ‡å—](./ä½¿ç”¨æŒ‡å—.md)ã€‹ï¼šå®‰è£…ã€APIã€å¸¸è§é—®é¢˜
- ã€Š[æ·»åŠ æ–°ä¸»é¢˜æŒ‡å—](./æ·»åŠ æ–°ä¸»é¢˜æŒ‡å—.md)ã€‹ï¼šå¦‚ä½•æ‰©å±•æ–°çš„ä¸»é¢˜é¢„è®¾
- ã€Š[å¼€å‘å·¥ä½œæµç¨‹](./å¼€å‘å·¥ä½œæµç¨‹.md)ã€‹ï¼šå¼€å‘ã€æ„å»ºã€å‘å¸ƒæµç¨‹

---

æœ‰ä»»ä½•è¿ç§»é—®é¢˜æ¬¢è¿åœ¨ä»“åº“æ Issueï¼Œæˆ–ç›´æ¥åœ¨ä¸»é¢˜é…ç½®ä¸­å¿ƒå°è¯•è°ƒå‚æ’æŸ¥ã€‚ç¥è¿ç§»é¡ºåˆ©ï¼ğŸ‰
