# ä¸»é¢˜ç³»ç»Ÿç»Ÿä¸€åŒ…å®æ–½è®¡åˆ’

## ğŸ“‹ å½“å‰çŠ¶æ€

âœ… **å·²å®Œæˆ**:
1. è¿ç§»æ–¹æ¡ˆæ–‡æ¡£ (`docs/ä¸»é¢˜ç³»ç»Ÿç»Ÿä¸€åŒ…è¿ç§»æ–¹æ¡ˆ.md`)
2. åŒ…åŸºç¡€ç»“æ„ï¼ˆpackage.json, tsconfig.json, rollup.config.jsï¼‰
3. ç»Ÿä¸€å¯¼å‡ºå…¥å£ (`src/index.ts`)
4. è¿ç§»æŒ‡å— (`MIGRATION_GUIDE.md`)

â³ **å¾…å®Œæˆ**:
1. å¤åˆ¶æ ¸å¿ƒæºä»£ç æ–‡ä»¶
2. å®ç°æ¡†æ¶é€‚é…å™¨
3. æµ‹è¯•å’ŒéªŒè¯
4. å®é™…è¿ç§»é¡¹ç›®

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### é˜¶æ®µä¸€ï¼šå®Œå–„åŒ…ç»“æ„ï¼ˆ1-2 å¤©ï¼‰

#### 1. å¤åˆ¶æ ¸å¿ƒæ–‡ä»¶

ä»ç°æœ‰é¡¹ç›®å¤åˆ¶ä»¥ä¸‹æ–‡ä»¶ï¼š

```bash
# åˆ›å»ºç›®å½•ç»“æ„
mkdir -p packages/theme-system/src/{tokens,transformer,provider,components,presets,utils}

# å¤åˆ¶ç±»å‹å®šä¹‰
cp apps/km-artizen-ai-ui/src/theme/tokens/types.ts packages/theme-system/src/tokens/

# å¤åˆ¶è½¬æ¢å™¨
cp apps/km-artizen-ai-ui/src/theme/transformer/index.ts packages/theme-system/src/transformer/

# å¤åˆ¶ç»„ä»¶
cp -r apps/km-artizen-ai-ui/src/theme/components/* packages/theme-system/src/components/

# å¤åˆ¶é¢„è®¾ä¸»é¢˜
cp -r apps/km-artizen-ai-ui/src/theme/presets/*.json packages/theme-system/src/presets/
```

#### 2. åˆ›å»ºæ ¸å¿ƒ ThemeProvider

åˆå¹¶ä¸¤ä¸ªé¡¹ç›®çš„ ThemeProvider å®ç°ï¼š

- ç§»é™¤ `require.context` ç›¸å…³ä»£ç ï¼ˆåœ¨é€‚é…å™¨ä¸­å¤„ç†ï¼‰
- æ·»åŠ  SSR å®‰å…¨æ£€æŸ¥
- ä¿æŒ API å…¼å®¹æ€§

**æ–‡ä»¶**: `src/provider/ThemeProvider.tsx`

#### 3. åˆ›å»ºé€‚é…å™¨

- **UmiJS é€‚é…å™¨**: `src/provider/umi-adapter.tsx`
  - ä½¿ç”¨ `require.context` è‡ªåŠ¨åŠ è½½ä¸»é¢˜
  - æ— éœ€ `'use client'` æŒ‡ä»¤

- **Next.js é€‚é…å™¨**: `src/provider/nextjs-adapter.tsx`
  - é™æ€å¯¼å…¥é¢„è®¾ä¸»é¢˜
  - éœ€è¦ `'use client'` æŒ‡ä»¤
  - å¤„ç† SSR

#### 4. åˆ›å»ºå·¥å…·å‡½æ•°

- **ä¸»é¢˜åŠ è½½å·¥å…·**: `src/utils/theme-loader.ts`
  - æ”¯æŒ `require.context` åŠ è½½
  - æ”¯æŒé™æ€å¯¼å…¥

- **SSR å·¥å…·**: `src/utils/ssr-utils.ts`
  - ç¯å¢ƒæ£€æµ‹å‡½æ•°
  - å®‰å…¨çš„ DOM æ“ä½œ

### é˜¶æ®µäºŒï¼šæ„å»ºå’Œæµ‹è¯•ï¼ˆ1 å¤©ï¼‰

#### 1. å®‰è£…ä¾èµ–

```bash
cd packages/theme-system
pnpm install
```

#### 2. æ„å»ºåŒ…

```bash
pnpm build
```

#### 3. ç±»å‹æ£€æŸ¥

```bash
pnpm type-check
```

#### 4. éªŒè¯è¾“å‡º

æ£€æŸ¥ `dist/` ç›®å½•ï¼š
- âœ… `index.js` (CommonJS)
- âœ… `index.esm.js` (ES Module)
- âœ… `index.d.ts` (ç±»å‹å®šä¹‰)
- âœ… `presets/*.json` (é¢„è®¾ä¸»é¢˜)

### é˜¶æ®µä¸‰ï¼šUmiJS é¡¹ç›®è¿ç§»ï¼ˆ1 å¤©ï¼‰

#### 1. å®‰è£…åŒ…

```bash
cd apps/km-artizen-ai-ui
pnpm add @km-design/theme-system
```

#### 2. æ›´æ–°ä»£ç 

- æ›´æ–° `app.tsx`
- æ›´æ–°ç»„ä»¶å¯¼å…¥
- æµ‹è¯•åŠŸèƒ½

#### 3. éªŒè¯

- åŠŸèƒ½æµ‹è¯•
- æ€§èƒ½æµ‹è¯•
- å…¼å®¹æ€§æµ‹è¯•

### é˜¶æ®µå››ï¼šNext.js é¡¹ç›®è¿ç§»ï¼ˆ1 å¤©ï¼‰

#### 1. å®‰è£…åŒ…

```bash
cd /Users/yylq/Desktop/kmflowui/km-flow-ui
pnpm add @km-design/theme-system
```

#### 2. æ›´æ–°ä»£ç 

- æ›´æ–° `ThemeWrapper`
- æ›´æ–°ç»„ä»¶å¯¼å…¥
- æµ‹è¯• SSR

#### 3. éªŒè¯

- åŠŸèƒ½æµ‹è¯•
- SSR æµ‹è¯•
- å…¼å®¹æ€§æµ‹è¯•

### é˜¶æ®µäº”ï¼šæ¸…ç†å’Œæ–‡æ¡£ï¼ˆ0.5 å¤©ï¼‰

#### 1. åˆ é™¤æ—§ä»£ç 

ç¡®è®¤ä¸€åˆ‡æ­£å¸¸åï¼Œåˆ é™¤æœ¬åœ°ä¸»é¢˜ç›®å½•ã€‚

#### 2. æ›´æ–°æ–‡æ¡£

- æ›´æ–°é¡¹ç›® README
- æ›´æ–°ä½¿ç”¨æ–‡æ¡£
- æ›´æ–°è¿ç§»è®°å½•

---

## ğŸ“ å®æ–½æ£€æŸ¥æ¸…å•

### åŒ…å¼€å‘é˜¶æ®µ

- [ ] å¤åˆ¶æ ¸å¿ƒæ–‡ä»¶åˆ°åŒ…
- [ ] åˆ›å»ºæ ¸å¿ƒ ThemeProvider
- [ ] åˆ›å»º UmiJS é€‚é…å™¨
- [ ] åˆ›å»º Next.js é€‚é…å™¨
- [ ] åˆ›å»ºå·¥å…·å‡½æ•°
- [ ] é…ç½®æ„å»ºå·¥å…·
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•ï¼ˆå¯é€‰ï¼‰
- [ ] ç¼–å†™æ–‡æ¡£

### UmiJS é¡¹ç›®è¿ç§»

- [ ] å®‰è£…åŒ…ä¾èµ–
- [ ] æ›´æ–° app.tsx
- [ ] æ›´æ–°ç»„ä»¶å¯¼å…¥
- [ ] åŠŸèƒ½æµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•
- [ ] åˆ é™¤æ—§ä»£ç ï¼ˆå¯é€‰ï¼‰

### Next.js é¡¹ç›®è¿ç§»

- [ ] å®‰è£…åŒ…ä¾èµ–
- [ ] æ›´æ–° ThemeWrapper
- [ ] æ›´æ–°ç»„ä»¶å¯¼å…¥
- [ ] åŠŸèƒ½æµ‹è¯•
- [ ] SSR æµ‹è¯•
- [ ] åˆ é™¤æ—§ä»£ç ï¼ˆå¯é€‰ï¼‰

### éªŒè¯é˜¶æ®µ

- [ ] ä¸¤ä¸ªé¡¹ç›®åŠŸèƒ½æ­£å¸¸
- [ ] æ— æ§åˆ¶å°é”™è¯¯
- [ ] æ€§èƒ½æ— å½±å“
- [ ] æ–‡æ¡£å®Œæ•´

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### åŒ…å¯¼å‡ºç­–ç•¥

```typescript
// ä¸»å…¥å£
export * from './provider/ThemeProvider';
export { UmiThemeProvider } from './provider/umi-adapter';
export { NextThemeProvider } from './provider/nextjs-adapter';

// é¢„è®¾ä¸»é¢˜ï¼ˆå¯é€‰ï¼‰
export { default as defaultTheme } from './presets/default.json';
```

### æ„å»ºé…ç½®

- **æ ¼å¼**: CommonJS + ES Module
- **ç±»å‹**: ç”Ÿæˆ `.d.ts` æ–‡ä»¶
- **é¢„è®¾ä¸»é¢˜**: å¤åˆ¶åˆ° `dist/presets` å’Œ `presets`

### ä¾èµ–ç®¡ç†

- **peerDependencies**: react, react-dom, antd
- **dependencies**: antdï¼ˆç”¨äºç±»å‹ï¼‰
- **devDependencies**: æ„å»ºå·¥å…·

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å‘åå…¼å®¹**: ä¿æŒç°æœ‰ API ä¸å˜
2. **ç±»å‹å®‰å…¨**: ç¡®ä¿ç±»å‹å®šä¹‰å®Œæ•´
3. **SSR å®‰å…¨**: æ‰€æœ‰ DOM æ“ä½œéƒ½éœ€è¦ç¯å¢ƒæ£€æµ‹
4. **åŒ…ä½“ç§¯**: æ§åˆ¶åŒ…ä½“ç§¯ï¼Œé¿å…è¿‡å¤§
5. **ç‰ˆæœ¬ç®¡ç†**: ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬

---

## ğŸ“Š é¢„æœŸæ”¶ç›Š

1. **ç»Ÿä¸€ç®¡ç†**: æ‰€æœ‰ä¸»é¢˜é…ç½®é›†ä¸­åœ¨ä¸€ä¸ªåŒ…ä¸­
2. **å‡å°‘é‡å¤**: ä¸å†éœ€è¦åœ¨å¤šä¸ªé¡¹ç›®ä¸­å¤åˆ¶å’Œç»´æŠ¤ç›¸åŒçš„ä»£ç 
3. **æ˜“äºæ‰©å±•**: æ–°é¡¹ç›®åªéœ€å®‰è£…åŒ…å³å¯ä½¿ç”¨ä¸»é¢˜ç³»ç»Ÿ
4. **ç‰ˆæœ¬æ§åˆ¶**: é€šè¿‡ npm ç‰ˆæœ¬ç®¡ç†ï¼Œå¯ä»¥å›æ»šåˆ°ä»»æ„ç‰ˆæœ¬
5. **å›¢é˜Ÿåä½œ**: å›¢é˜Ÿæˆå‘˜å¯ä»¥ç‹¬ç«‹å¼€å‘å’Œæµ‹è¯•ä¸»é¢˜åŒ…

---

## ğŸ“ è”ç³»å’Œæ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»ï¼š
- ç»´æŠ¤å›¢é˜Ÿ: KM Design Team
- æ–‡æ¡£: æŸ¥çœ‹ `MIGRATION_GUIDE.md` å’Œ `README.md`

---

**åˆ›å»ºæ—¥æœŸ**: 2025-01-14  
**ç‰ˆæœ¬**: v1.0.0  
**çŠ¶æ€**: è§„åˆ’é˜¶æ®µ

